<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="css/prplnf.css">
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
</head>
<body>

<form id="loginform" action="" style="border:1px solid #ccc">
  <div class="container">
    <h1>Log In</h1>
    <p>Please fill in this form to create an account.</p>
    <hr>

    <label for="username"><b>Username</b></label>
    <input type="text" placeholder="Enter Username" name="usename" required>

    <label for="password"><b>Password</b></label>
    <input type="password" placeholder="Enter Password" name="password" required>
    
    <p>By creating an account you agree to our <a href="#" style="color:dodgerblue">Terms & Privacy</a>.</p>

    <div class="clearfix">
      <button type="button" class="cancelbtn">Cancel</button>
      <button type="submit" class="loginbtn" id="loginbtn">Log In</button>
    </div>
  </div>
</form>

<script type="text/javascript">
    $('#loginform').submit(async(e) => {
        e.preventDefault();
        const data = {
            username: e.target.elements[0].value,
            password: e.target.elements[1].value,
        }
        console.log(JSON.stringify(data));

        const response = await fetch('http://127.0.0.1:5000/tokens', {
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            mode: 'cors', // no-cors, *cors, same-origin
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(data) // body data type must match "Content-Type" header
        });
        if(!response.ok) {
            let json = await response.json()
            console.log(response.status)
            console.log(json)     
        }   
        else {
            let json = await response.json()
            console.log(json)              
            <!-- console.log(json.token)               -->
            console.log(response.status)  
            document.cookie = "prpln_token=" + json.token;
            window.location.href = 'file.html';
        }
    });
</script>
</body>
</html>
